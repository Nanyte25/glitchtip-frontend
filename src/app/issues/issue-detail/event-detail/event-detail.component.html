<section *ngIf="event$ | async as event" class="mat-typography">
  <section class="header">
    <div>
      <h2>Event</h2>
      <p>
        <a>{{ event?.eventID }}</a>
      </p>
      <p>
        <span *ngIf="event?.dateCreated" class="space">{{
          event?.dateCreated | date: "long"
        }}</span>
      </p>
    </div>
    <div>
      <a
        mat-button
        [routerLink]="(previousEventUrl$ | async) || ''"
        [disabled]="(previousEvent$ | async) === false"
        ><mat-icon>keyboard_arrow_left</mat-icon> Older</a
      >
      <a
        mat-button
        [routerLink]="(nextEventUrl$ | async) || ''"
        [disabled]="(nextEvent$ | async) === false"
        >Newer <mat-icon>keyboard_arrow_right</mat-icon></a
      >
    </div>
  </section>

  <section
    *ngIf="event?.contexts?.browser || event?.contexts?.os"
    class="location"
  >
    <mat-divider></mat-divider>
    <div *ngIf="event?.user" class="wrapper">
      <mat-icon>face</mat-icon>
      <div class="spacer">
        <p class="mat-body-strong">
          {{ event?.user.email ? event?.user.email : event?.user.ip_address }}
        </p>
        <p *ngIf="event?.user.id" class="mat-small mat-caption">
          <span class="bold">Version:</span
          ><span class="spacer-small">{{ event?.user.id }}</span>
        </p>
      </div>
    </div>
    <div *ngIf="event?.contexts?.browser" class="wrapper">
      <mat-icon>tab</mat-icon>
      <div class="spacer">
        <p class="mat-body-strong">{{ event?.contexts?.browser?.name }}</p>
        <p class="mat-small mat-caption">
          <span class="bold">Version:</span
          ><span class="spacer-small">{{
            event?.contexts?.browser?.version
          }}</span>
        </p>
      </div>
    </div>
    <div *ngIf="event?.contexts?.os" class="wrapper">
      <mat-icon>laptop</mat-icon>
      <div class="spacer">
        <p class="mat-body-strong">{{ event?.contexts?.os?.name }}</p>
        <p class="mat-small mat-caption">
          <span class="bold">Version:</span
          ><span class="spacer-small">{{
            event?.contexts?.os?.version
              ? event?.contexts?.os?.version
              : "unknown"
          }}</span>
        </p>
      </div>
    </div>
  </section>

  <mat-divider *ngIf="event?.contexts?.browser"></mat-divider>

  <app-entry-message></app-entry-message>
  <app-entry-exception
    [eventTitle]="event?.title"
    [platform]="event?.platform"
  ></app-entry-exception>
  <app-entry-csp></app-entry-csp>
  <app-entry-request></app-entry-request>
  <section *ngFor="let context of event.contexts | keyvalue">
    <mat-divider></mat-divider>
    <h3>
      {{ context.value.type }}

      <ng-container *ngIf="context.value.type; else elseBlock">
        ({{ context.key }})
      </ng-container>
      <ng-template #elseBlock>{{ context.key }}</ng-template>
    </h3>
    <dl>
      <ng-container *ngFor="let context_entry of context.value | keyvalue">
        <app-entry-data
          *ngIf="context_entry.key !== 'type'"
          [key]="context_entry.key"
          [value]="context_entry.value"
        ></app-entry-data>
      </ng-container>
    </dl>
  </section>

  <section *ngIf="event.context">
    <mat-divider></mat-divider>
    <h3>Additional Data</h3>
    <dl>
      <app-entry-data
        *ngFor="let context of event.context | keyvalue"
        [key]="context.key"
        [value]="context.value | json"
      >
      </app-entry-data>
    </dl>
  </section>
  <section *ngIf="event?.sdk">
    <mat-divider></mat-divider>
    <h3>SDK</h3>
    <dl>
      <app-entry-data key="name" [value]="event?.sdk.name"></app-entry-data>
      <app-entry-data
        key="version"
        [value]="event?.sdk.version"
      ></app-entry-data>
    </dl>
  </section>
</section>
