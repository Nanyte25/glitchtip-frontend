<mat-card>
  <mat-card-title>Project Alerts</mat-card-title>
  <mat-divider></mat-divider>
  <mat-card-content>
    <ng-container *ngIf="(initialLoad$ | async) === false; else afterLoad">
      <div class="loading"></div>
    </ng-container>
    <ng-template #afterLoad>
      <!-- <div *ngFor="let alert of projectAlerts$ | async"> -->
      <!-- <div>{{ alert.timespan_minutes }} {{ alert.quantity }}|</div> -->

      <!-- <ng-container *ngIf="projectAlerts$ | async as alert">
        <form [formGroup]="projectAlertForm">
          <ng-container formArrayName="alertTiming">
            <div *ngFor="let _ of alertTiming.controls; index as i">
              <ng-container [formGroupName]="i">
                <button (click)="removeAlert(alert[i].pk, i)">
                  Delete Alert
                </button>
                <label>timespan</label>
                <input formControlName="timespan_minutes" />
                <label>quantity</label>
                <input formControlName="quantity" />
                <button (click)="updateAlertTiming(alert[i].pk, i)">
                  update time/quantity
                </button>
              </ng-container>
              <div *ngFor="let recipient of alert[i].alertRecipients">
                hi {{ recipient | json }}
                <button (click)="removeRecipient(alert[i].pk, recipient.pk)">
                  remove recipient
                </button>
              </div>
              <button (click)="addRecipient()">add recipient</button>
            </div>
          </ng-container>
        </form>
      </ng-container> -->
      <!-- </div> -->
      <!--  <div
        class="default-settings"
        [class.add-padding]="(projectAlerts$ | async) === null"
      >
        <div class="default-alerts">
          <ng-container
            *ngIf="(projectAlerts$ | async) === null; else alertsAreOn"
          >
            <p class="mat-body-strong">Project Alerts Off</p>
            <p class="mat-body-1">
              You are not currently receiving any alerts for this project.
            </p>
          </ng-container>
          <ng-template #alertsAreOn>
            <p class="mat-body-strong">Project Alerts On</p>
            <p class="mat-body-1">
              These preferences apply to everyone who is part of this project
            </p>
          </ng-template>
        </div>
        <div class="button-group">
          <div class="button-and-loading">
            <mat-spinner
              *ngIf="(alertToggleLoading$ | async) === true"
              diameter="24"
            ></mat-spinner>
            <mat-button-toggle-group
              name="defaultNotifications"
              aria-label="Default Notifications"
            >
              <mat-button-toggle
                value="onDefault"
                (change)="toggleProjectAlerts()"
                [class.underline]="projectAlerts$ | async"
                [checked]="(projectAlerts$ | async) !== null"
                >On</mat-button-toggle
              >
              <mat-button-toggle
                value="offDefault"
                (change)="toggleProjectAlerts()"
                [class.underline]="(projectAlerts$ | async) === null"
                [checked]="(projectAlerts$ | async) === null"
                >Off</mat-button-toggle
              >
            </mat-button-toggle-group>
          </div>
          <mat-error
            *ngIf="alertToggleError$ | async as error"
            class="mat-small"
            >{{ error }}</mat-error
          >
        </div>
      </div>
     -->

      <!-- <div
        *ngFor="let alert of projectAlerts$ | async; let i = index"
        class="alerts"
      >
        <div class="alert-header common-flex">
          <h3>Alert {{ i + 1 }}</h3>
          <button
            mat-stroked-button
            color="primary"
            (click)="removeAlert(alert.pk, i + 1)"
          >
            Remove Alert {{ i + 1 }}
          </button>
        </div>
        <div class="server-error">
          <mat-error *ngIf="error$ | async as error">{{ error }}</mat-error>
        </div>
        <form
          class="flex"
          [formGroup]="projectAlertForm"
          (ngSubmit)="onSubmit()"
        >
          <p>
            <span
              >If&nbsp;an&nbsp;<span
                class="tooltip"
                matTooltip="An event is every occurance of the same error (aka: issue) in your application."
                >event</span
              >&nbsp;happens</span
            >
            <mat-form-field>
              <mat-label>Quantity</mat-label>
              <input
                matInput
                min="0"
                max="10000"
                type="number"
                autocomplete="off"
                formControlName="quantity"
                [errorStateMatcher]="matcher"
                placeholder="#"
              />
              <mat-error *ngIf="projectAlertForm.get('quantity')?.errors">
                <span *ngIf="projectAlertForm.get('quantity')?.errors?.min"
                  >The quantity needs to be greater than or equal to 0.</span
                >
                <span
                  *ngIf="
                    projectAlertForm.get('quantity')?.errors?.invalidNumber
                  "
                  >Enter a number.
                </span>
                <span *ngIf="projectAlertForm.get('quantity')?.errors?.required"
                  >This field is required.</span
                >
              </mat-error>
            </mat-form-field>
            <span
              >time<span *ngIf="projectAlertForm.get('quantity')?.value !== 1"
                >s</span
              >&nbsp;in</span
            >
            <mat-form-field>
              <mat-label>Timespan</mat-label>
              <input
                matInput
                min="0"
                max="10000"
                type="number"
                autocomplete="off"
                formControlName="timespan_minutes"
                [errorStateMatcher]="matcher"
                placeholder="#"
              />
              <mat-error
                *ngIf="projectAlertForm.get('timespan_minutes')?.errors"
              >
                <span
                  *ngIf="projectAlertForm.get('timespan_minutes')?.errors?.min"
                  >The timespan needs to be greater than or equal to 0.</span
                >
                <span
                  *ngIf="
                    projectAlertForm.get('timespan_minutes')?.errors
                      ?.invalidNumber
                  "
                  >Enter a number.
                </span>
                <span
                  *ngIf="
                    projectAlertForm.get('timespan_minutes')?.errors?.required
                  "
                  >This field is required.</span
                >
              </mat-error>
            </mat-form-field>
            <span
              >minute<span
                *ngIf="projectAlertForm.get('timespan_minutes')?.value !== 1"
                >s</span
              >,&nbsp;send&nbsp;an&nbsp;email.</span
            >
          </p>
          <app-loading-button
            buttonText="Update"
            [disabled]="
              projectAlertForm.get('timespan_minutes')?.value ===
                alert.timespan_minutes &&
              projectAlertForm.get('quantity')?.value === alert.quantity
            "
            [loading]="(loading$ | async) === true"
            buttonStyle="basic"
          ></app-loading-button>
        </form>
        <ul class="alert-list">
          <li
            *ngFor="let recipient of alert.alertRecipients"
            class="common-flex"
          >
            <div class="common-flex">
              <div
                *ngIf="recipient.recipientType === 'email'"
                class="common-flex"
              >
                <mat-icon class="alert-list-icon">email</mat-icon>
                <span>Email team members on this project.</span>
              </div>
              <div class="common-flex">
                <svg
                  *ngIf="recipient.recipientType === 'webhook'"
                  class="alert-list-icon"
                >
                  <use xlink:href="#webhook"></use>
                </svg>
                <span>{{ recipient.url }}</span>
              </div>
            </div>
            <button
              mat-icon-button
              attr.aria-label="delete-{{ recipient.url }}"
            >
              <mat-icon class="alert-list-icon-delete" color="primary"
                >delete_outline</mat-icon
              >
            </button>
          </li>
        </ul>
        <app-loading-button
          class="add-recipient-button"
          buttonText="Add Recipient"
          buttonStyle="stroked"
          icon="add"
        ></app-loading-button>
      </div> -->
      <mat-divider></mat-divider>
      <div class="notifications-wrapper">
        <div class="notifications-text">
          <p class="mat-body-strong">Personal project notifications</p>
          <p>
            Edit whether or not you want to receive notifications for this
            project
          </p>
        </div>
        <div class="notifications-link">
          <a
            mat-flat-button
            color="primary"
            routerLink="/profile/notifications"
          >
            Edit Preferences
          </a>
        </div>
      </div></ng-template
    >
  </mat-card-content>
</mat-card>
