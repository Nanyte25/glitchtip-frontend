<section
class="l-body l-body--full-width mat-elevation-z0"
*ngIf="paginator$ | async as paginator"
>
    <header class="page-header">
        <h1 class="mat-display-1">
        Uptime Monitors
        <ng-container *ngIf="monitors$ | async as monitors">
            ({{ monitors.length }})
        </ng-container>
        </h1>
        <a
        mat-stroked-button
        color="primary"
        [routerLink]="[]"
        >
            <mat-icon>add</mat-icon>
            Add monitor
        </a>
    </header>
    <div *ngIf="monitors$ | async as monitors" class="wrapper">
        <table
        mat-table
        [dataSource]="monitors$"
        class="mat-elevation-z2"
        >
            <ng-container matColumnDef="statusColor">
                <td 
                    mat-cell *matCellDef="let monitor"
                    class="status-color status-color--{{ monitor.isUp }}"
                >
                </td>
            </ng-container>
            <ng-container matColumnDef="name">
                <td 
                    mat-cell *matCellDef="let monitor"
                >
                    <div class="monitor-name">
                        <a [matTooltip]="monitor.name" [routerLink]="">{{ monitor.name }}</a>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="url">
                <td
                mat-cell
                *matCellDef="let monitor"
                class="monitor-url"
                > 
                    <div class="url-box">
                        <span [matTooltip]="monitor.url" class="url-string">{{ monitor.url }}</span>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="status">
                <td 
                mat-cell *matCellDef="let monitor"
                class="status"
                > 
                    <ng-container *ngIf="monitor.lastChange; else notYet">
                        <span *ngIf="monitor.isUp">Up</span>
                        <span *ngIf="!monitor.isUp">Down</span>
                        {{ monitor.lastChange | timeFor }}
                    </ng-container>
                    <ng-template #notYet>
                        <span>Not yet live</span>
                    </ng-template>
                </td>
            </ng-container>
            <ng-container matColumnDef="pagination">
                <td
                  mat-footer-cell
                  *matFooterCellDef
                  [attr.colspan]="displayedColumns.length"
                  class="footer"
                >
                  <ng-container *ngIf="(loading$ | async) === false">
                    <button
                      [routerLink]="[]"
                      [queryParams]="paginator.previousPageParams || {}"
                      queryParamsHandling="merge"
                      mat-button
                      [disabled]="paginator.hasPreviousPage === false"
                    >
                      <mat-icon>keyboard_arrow_left</mat-icon>
                    </button>
                    <button
                      [routerLink]="[]"
                      [queryParams]="paginator.nextPageParams || {}"
                      queryParamsHandling="merge"
                      mat-button
                      [disabled]="paginator.hasNextPage === false"
                    >
                      <mat-icon>keyboard_arrow_right</mat-icon>
                    </button>
                  </ng-container>
                  <div *ngIf="loading$ | async" class="spinner-container">
                    <mat-progress-spinner
                      [diameter]="33"
                      color="primary"
                      mode="indeterminate"
                    ></mat-progress-spinner>
                  </div>
                </td>
              </ng-container>
            <tr mat-row
            *matRowDef="let row; columns: displayedColumns;"
            class="monitor-row"
            ></tr>
            <tr mat-footer-row *matFooterRowDef="['pagination']"></tr>
        </table>
    </div>

<!-- <div *ngIf="(monitors$ | async) as monitors"> 
    <div *ngFor="let monitor of monitors">
        <p>{{ monitor.name }}</p>
        <p>{{ monitor.url }}</p>
    </div>
</div> -->
</section>

